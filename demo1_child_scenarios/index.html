<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEMO 1: Child Scenario OEQ/CEQ Classifier</title>
    <style>
        /* ECE Question Classification System - Professional Dual Theme Interface */
        /* Microsoft Fluent Design System - Light Mode Default */

        /* THEME SYSTEM - CSS CUSTOM PROPERTIES */
        :root {
            /* LIGHT THEME (DEFAULT) - Microsoft Fluent Colors */

            /* Primary Colors */
            --primary-50: #F3F9FF;
            --primary-100: #E1F1FF;
            --primary-500: #0078D4;
            --primary-600: #106EBE;
            --primary-700: #005A9E;
            --primary-900: #003D6B;

            /* Surface Hierarchy - Light Mode (Soft & Comfortable) */
            --surface-50: #F4F1EE;     /* Cards - warm linen, like quality notebook paper */
            --surface-100: #EFEBE8;    /* Page background - soft mushroom/parchment */
            --surface-200: #E8E3DF;    /* Secondary backgrounds - muted warm beige */
            --surface-300: #DFD9D4;    /* Subtle borders - warm sand */
            --surface-400: #D4CDC7;    /* Medium borders - soft taupe */
            --surface-500: #C7BEB6;    /* Strong borders - warm stone */
            --surface-600: #AFA59D;    /* Disabled elements - muted brown */

            /* Text Hierarchy - Light Mode */
            --text-primary: #1F1F1F;   /* High contrast text */
            --text-secondary: #424242; /* Medium contrast text */
            --text-tertiary: #6B6B6B;  /* Low contrast text */
            --text-disabled: #A6A6A6;  /* Disabled text */
            --text-inverse: #FFFFFF;   /* Text on dark backgrounds */

            /* Semantic Colors - Light Theme (Warm & Friendly) */
            --success-50: #F4FAF4;     /* Soft warm green background */
            --success-500: #107C10;
            --success-600: #0E6B0E;
            --success-text: #0E6B0E;

            --warning-50: #FFF9F2;     /* Warm cream orange background */
            --warning-500: #FF8C00;
            --warning-600: #E67A00;
            --warning-text: #CC6900;

            --error-50: #FDF4F5;       /* Soft warm pink background */
            --error-500: #D13438;
            --error-600: #B71C1C;
            --error-text: #A91E22;

            /* Microsoft Fluent Effects */
            --elevation-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), 0 8px 16px rgba(0, 0, 0, 0.1);
            --elevation-shadow-large: 0 4px 8px rgba(0, 0, 0, 0.12), 0 16px 32px rgba(0, 0, 0, 0.12);
            --border-radius-small: 4px;
            --border-radius-medium: 8px;
            --border-radius-large: 12px;
            --transition-fast: 0.2s ease;
            --transition-medium: 0.3s ease;
        }

        /* DARK THEME OVERRIDES */
        [data-theme="dark"] {
            /* Primary Colors - Dark Mode Optimized */
            --primary-50: #001529;
            --primary-100: #002040;
            --primary-500: #60CDFF;
            --primary-600: #4FC3F7;
            --primary-700: #29B6F6;

            /* Surface Hierarchy - Dark Mode */
            --surface-50: #2D2D2D;     /* Cards, elevated surfaces */
            --surface-100: #1C1C1C;    /* Page background */
            --surface-200: #202020;    /* Secondary backgrounds */
            --surface-300: #383838;    /* Subtle borders */
            --surface-400: #484848;    /* Medium borders */
            --surface-500: #5C5C5C;    /* Strong borders */
            --surface-600: #6B6B6B;    /* Disabled elements */

            /* Text Hierarchy - Dark Mode */
            --text-primary: #FFFFFF;   /* High contrast text */
            --text-secondary: #E1E1E1; /* Medium contrast text */
            --text-tertiary: #BFBFBF;  /* Low contrast text */
            --text-disabled: #8A8A8A;  /* Disabled text */
            --text-inverse: #1F1F1F;   /* Text on light backgrounds */

            /* Semantic Colors - Dark Theme */
            --success-50: #1C2A1C;     /* Dark green background */
            --success-500: #6BB26B;
            --success-600: #5A9E5A;
            --success-text: #6BB26B;

            --warning-50: #2A1F0D;     /* Dark amber background */
            --warning-500: #D18B47;
            --warning-600: #C17A36;
            --warning-text: #D18B47;

            --error-50: #2A1215;       /* Dark red background */
            --error-500: #E74856;
            --error-600: #D13438;
            --error-text: #E74856;

            /* Dark Mode Effects */
            --elevation-shadow: 0 2px 4px rgba(0, 0, 0, 0.3), 0 8px 16px rgba(0, 0, 0, 0.3);
            --elevation-shadow-large: 0 4px 8px rgba(0, 0, 0, 0.4), 0 16px 32px rgba(0, 0, 0, 0.4);
        }

        /* BASE STYLES */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            font-size: 16px;
            line-height: 1.5;
            color: var(--text-primary);
            background: var(--surface-100);
            min-height: 100vh;
            transition: background-color var(--transition-medium), color var(--transition-medium);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* THEME TOGGLE COMPONENT */
        .theme-toggle {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 9999;
            background: var(--surface-50);
            border: 2px solid var(--surface-400);
            border-radius: var(--border-radius-large);
            padding: 10px 14px;
            display: flex !important;
            align-items: center;
            gap: 8px;
            box-shadow: var(--elevation-shadow-large);
            transition: all var(--transition-medium);
            cursor: pointer;
        }

        .theme-toggle:hover {
            background: var(--surface-200);
            border-color: var(--primary-500);
            transform: translateY(-1px);
        }

        .theme-icon {
            width: 20px;
            height: 20px;
            color: var(--text-secondary);
            transition: color var(--transition-fast);
        }

        .theme-toggle-switch {
            width: 40px;
            height: 20px;
            background: var(--surface-300);
            border-radius: 10px;
            position: relative;
            transition: background-color var(--transition-fast);
        }

        .theme-toggle-switch.active {
            background: var(--primary-500);
        }

        .theme-toggle-knob {
            width: 16px;
            height: 16px;
            background: var(--surface-50);
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform var(--transition-fast);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .theme-toggle-switch.active .theme-toggle-knob {
            transform: translateX(20px);
        }

        .theme-toggle:hover .theme-icon {
            opacity: 1;
        }

        /* LAYOUT COMPONENTS */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
            min-height: 100vh;
        }

        header {
            background: var(--surface-50);
            border: 1px solid var(--surface-300);
            border-radius: var(--border-radius-large);
            padding: 32px;
            margin-bottom: 24px;
            box-shadow: var(--elevation-shadow);
            transition: all var(--transition-medium);
        }

        header h1 {
            font-size: 2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            line-height: 1.2;
        }

        header p {
            color: var(--text-secondary);
            font-size: 1.125rem;
            margin-bottom: 24px;
        }

        /* TAB NAVIGATION */
        .tab-navigation {
            display: flex;
            gap: 4px;
            background: var(--surface-200);
            padding: 4px;
            border-radius: var(--border-radius-medium);
            border: 1px solid var(--surface-300);
        }

        .tab-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            border-radius: var(--border-radius-small);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
            flex: 1;
            justify-content: center;
            min-height: 44px;
        }

        .tab-btn:hover {
            background: var(--surface-300);
            color: var(--text-primary);
        }

        .tab-btn.active {
            background: var(--surface-50);
            color: var(--primary-500);
            box-shadow: var(--elevation-shadow);
            font-weight: 600;
        }

        .tab-btn svg {
            width: 16px;
            height: 16px;
            opacity: 0.8;
        }

        .tab-btn.active svg {
            opacity: 1;
        }

        /* TAB CONTENT */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* CONTENT CARDS */
        .scenario-card {
            background: var(--surface-50);
            border: 1px solid var(--surface-300);
            border-radius: var(--border-radius-large);
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: var(--elevation-shadow);
            transition: all var(--transition-medium);
        }

        .scenario-card:hover {
            box-shadow: var(--elevation-shadow-large);
            border-color: var(--primary-500);
        }

        .scenario-card h2 {
            color: var(--text-primary);
            margin-bottom: 16px;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .scenario-card h3 {
            color: var(--text-primary);
            margin-bottom: 12px;
            font-size: 1.125rem;
            font-weight: 600;
        }

        .scenario-card p {
            color: var(--text-secondary);
            margin-bottom: 16px;
            line-height: 1.6;
        }

        /* BUTTONS */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius-small);
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all var(--transition-fast);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary-500);
            color: var(--text-inverse);
            box-shadow: var(--elevation-shadow);
        }

        .btn-primary:hover {
            background: var(--primary-600);
            transform: translateY(-1px);
            box-shadow: var(--elevation-shadow-large);
        }

        .btn-secondary {
            background: var(--surface-200);
            color: var(--text-primary);
            border: 1px solid var(--surface-400);
        }

        .btn-secondary:hover {
            background: var(--surface-300);
            border-color: var(--primary-500);
        }

        /* INPUT FIELDS */
        .text-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--surface-300);
            border-radius: var(--border-radius-small);
            font-size: 14px;
            color: var(--text-primary);
            background: var(--surface-50);
            transition: all var(--transition-fast);
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-50);
        }

        .text-input::placeholder {
            color: var(--text-tertiary);
        }

        /* METRIC GRIDS */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }

        .metric-card {
            background: var(--surface-50);
            border: 1px solid var(--surface-300);
            border-radius: var(--border-radius-medium);
            padding: 20px;
            text-align: center;
            transition: all var(--transition-medium);
        }

        .metric-card:hover {
            border-color: var(--primary-500);
            box-shadow: var(--elevation-shadow);
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-500);
            margin-bottom: 4px;
        }

        .metric-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        /* TABLES */
        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--surface-50);
            border-radius: var(--border-radius-medium);
            overflow: hidden;
            box-shadow: var(--elevation-shadow);
        }

        th, td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--surface-300);
        }

        th {
            background: var(--surface-200);
            font-weight: 600;
            color: var(--text-primary);
        }

        td {
            color: var(--text-secondary);
        }

        /* FOOTER */
        .footer {
            margin-top: 40px;
            padding: 24px 0;
            border-top: 1px solid var(--surface-300);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: var(--text-tertiary);
        }

        .footer-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-logo {
            width: 24px;
            height: 24px;
            background: var(--primary-500);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 12px;
        }

        .footer-right {
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: 'Courier New', monospace;
        }

        .build-number {
            background: var(--surface-200);
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .footer a {
            color: var(--primary-500);
            text-decoration: none;
            transition: color var(--transition-fast);
        }

        .footer a:hover {
            color: var(--primary-600);
            text-decoration: underline;
        }

        /* SETTINGS BUTTON */
        .settings-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            background: var(--primary-500);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--elevation-shadow-large);
            transition: all var(--transition-medium);
            z-index: 999;
        }

        .settings-fab:hover {
            background: var(--primary-600);
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .settings-fab svg {
            width: 24px;
            height: 24px;
            color: white;
        }

        /* SETTINGS MODAL */
        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            animation: fadeIn 0.3s ease;
        }

        .settings-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .settings-content {
            background: var(--surface-50);
            border-radius: var(--border-radius-large);
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--elevation-shadow-large);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .settings-header {
            padding: 24px;
            border-bottom: 1px solid var(--surface-300);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .settings-header h2 {
            margin: 0;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .settings-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px;
            transition: color var(--transition-fast);
        }

        .settings-close:hover {
            color: var(--text-primary);
        }

        .settings-body {
            padding: 24px;
        }

        .settings-section {
            margin-bottom: 32px;
        }

        .settings-section h3 {
            color: var(--text-primary);
            margin-bottom: 16px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .settings-group {
            background: var(--surface-100);
            padding: 16px;
            border-radius: var(--border-radius-medium);
            border: 1px solid var(--surface-300);
            margin-bottom: 16px;
        }

        .setting-item {
            margin-bottom: 16px;
        }

        .setting-item:last-child {
            margin-bottom: 0;
        }

        .setting-item label {
            display: block;
            color: var(--text-primary);
            font-weight: 500;
            margin-bottom: 8px;
        }

        .setting-item select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--surface-400);
            border-radius: var(--border-radius-small);
            background: var(--surface-50);
            color: var(--text-primary);
            font-size: 14px;
            transition: all var(--transition-fast);
        }

        .setting-item select:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-50);
        }

        .setting-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
        }

        .setting-checkbox input[type="checkbox"] {
            margin-top: 4px;
        }

        .setting-checkbox-label {
            flex: 1;
        }

        .setting-checkbox-label .label-title {
            color: var(--text-primary);
            font-weight: 500;
            display: block;
            margin-bottom: 4px;
        }

        .setting-checkbox-label .label-desc {
            color: var(--text-secondary);
            font-size: 13px;
        }

        .settings-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--surface-300);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }

            .tab-navigation {
                flex-direction: column;
            }

            .tab-btn {
                justify-content: flex-start;
            }

            header {
                padding: 20px;
            }

            header h1 {
                font-size: 1.5rem;
            }

            .metric-grid {
                grid-template-columns: 1fr;
            }

            .footer {
                flex-direction: column;
                gap: 12px;
                text-align: center;
            }

            .footer-right {
                flex-direction: column;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Theme Toggle -->
    <div class="theme-toggle" id="themeToggle">
        <svg class="theme-icon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 18.5C15.59 18.5 18.5 15.59 18.5 12C18.5 8.41 15.59 5.5 12 5.5C8.41 5.5 5.5 8.41 5.5 12C5.5 15.59 8.41 18.5 12 18.5ZM12 2L14.39 5.42C13.65 5.15 12.84 5 12 5C11.16 5 10.35 5.15 9.61 5.42L12 2ZM3.34 7L6.76 4.61C6.15 5.85 5.85 7.15 5.85 8.5C5.85 9.85 6.15 11.15 6.76 12.39L3.34 17ZM3.34 17L6.76 19.39C6.15 18.15 5.85 16.85 5.85 15.5C5.85 14.15 6.15 12.85 6.76 11.61L3.34 7ZM12 22L9.61 18.58C10.35 18.85 11.16 19 12 19C12.84 19 13.65 18.85 14.39 18.58L12 22ZM20.66 17L17.24 19.39C17.85 18.15 18.15 16.85 18.15 15.5C18.15 14.15 17.85 12.85 17.24 11.61L20.66 7ZM20.66 7L17.24 4.61C17.85 5.85 18.15 7.15 18.15 8.5C18.15 9.85 17.85 11.15 17.24 12.39L20.66 17Z"/>
        </svg>
        <div class="theme-toggle-switch" id="themeSwitch">
            <div class="theme-toggle-knob"></div>
        </div>
        <svg class="theme-icon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.4 6.35,17.41C9.37,20.43 14,20.54 17.33,17.97Z"/>
        </svg>
    </div>

    <!-- Settings Button (FAB) -->
    <div class="settings-fab" id="settingsFab" onclick="openSettings()">
        <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11.03L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11.03C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
        </svg>
    </div>

    <!-- Settings Modal -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
            <div class="settings-header">
                <h2>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11.03L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11.03C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                    </svg>
                    Settings
                </h2>
                <button class="settings-close" onclick="closeSettings()">&times;</button>
            </div>

            <div class="settings-body">
                <!-- Scenarios Section -->
                <div class="settings-section">
                    <h3>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19,2L14,6.5V17.5L19,13V2M6.5,5C4.55,5 2.45,5.4 1,6.5V21.16C1,21.41 1.25,21.66 1.5,21.66C1.6,21.66 1.65,21.59 1.75,21.59C3.1,20.94 5.05,20.5 6.5,20.5C8.45,20.5 10.55,20.9 12,22C13.35,21.15 15.8,20.5 17.5,20.5C19.15,20.5 20.85,20.81 22.25,21.56C22.35,21.61 22.4,21.59 22.5,21.59C22.75,21.59 23,21.34 23,21.09V6.5C22.4,6.05 21.75,5.75 21,5.5V19C19.9,18.65 18.7,18.5 17.5,18.5C15.8,18.5 13.35,19.15 12,20V13L12,8.82C10.55,7.85 8.45,7.5 6.5,7.5C5.05,7.5 3.1,7.94 1.75,8.59C1.65,8.59 1.6,8.66 1.5,8.66C1.25,8.66 1,8.41 1,8.16V6.5C2.45,5.4 4.55,5 6.5,5C8.45,5 10.55,5.4 12,6.5V8.82Z"/>
                        </svg>
                        Scenarios
                    </h3>

                    <div class="settings-group">
                        <div class="setting-item">
                            <label for="scenarioSource">Data Source</label>
                            <select id="scenarioSource" onchange="updateScenarioSource(this.value)">
                                <option value="simulations">Simulations (Synthetic Scenarios)</option>
                                <option value="real_transcriptions">Real Transcriptions (Gold Star Videos)</option>
                            </select>
                            <p style="font-size: 12px; color: var(--text-tertiary); margin-top: 4px;" id="sourceDescription">
                                AI-generated educational scenarios for training
                            </p>
                        </div>

                        <div class="setting-checkbox">
                            <input type="checkbox" id="showEducatorResponse" onchange="updateSettings()">
                            <div class="setting-checkbox-label">
                                <span class="label-title">Show Educator Responses</span>
                                <span class="label-desc">Display what the educator actually said in gold star examples</span>
                            </div>
                        </div>

                        <div class="setting-checkbox">
                            <input type="checkbox" id="showConfidenceScores" checked onchange="updateSettings()">
                            <div class="setting-checkbox-label">
                                <span class="label-title">Display OEQ/CEQ Confidence Scores</span>
                                <span class="label-desc">Show AI confidence scores for educator responses</span>
                            </div>
                        </div>

                        <div class="setting-checkbox">
                            <input type="checkbox" id="comparisonMode" onchange="updateSettings()">
                            <div class="setting-checkbox-label">
                                <span class="label-title">Enable Comparison Mode</span>
                                <span class="label-desc">Compare your responses with gold star educators</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Display Section -->
                <div class="settings-section">
                    <h3>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>
                        </svg>
                        Display
                    </h3>

                    <div class="settings-group">
                        <div class="setting-checkbox">
                            <input type="checkbox" id="debugMode" onchange="updateSettings()">
                            <div class="setting-checkbox-label">
                                <span class="label-title">Console Debug Output</span>
                                <span class="label-desc">Show detailed ML analysis in browser console</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="settings-footer">
                <button class="btn btn-secondary" onclick="closeSettings()">Cancel</button>
                <button class="btn btn-primary" onclick="applySettings()">Apply</button>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>ECE Question Classification System</h1>
            <p>AI-powered assessment tool for early childhood education questioning techniques</p>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="showTab('demo')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    Live Demo
                </button>
                <button class="tab-btn" onclick="showTab('synthetic')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                    </svg>
                    Synthetic Data
                </button>
                <button class="tab-btn" onclick="showTab('metrics')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/>
                    </svg>
                    Performance
                </button>
                <button class="tab-btn" onclick="showTab('retraining')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"/>
                    </svg>
                    Model Training
                </button>
            </div>
        </header>

        <!-- Live Demo Tab -->
        <div id="demo-tab" class="tab-content active">
            <!-- Scenario Display -->
            <div class="scenario-card" id="scenarioCard">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <span style="font-size: 14px; font-weight: 500; color: var(--text-secondary);" id="scenarioCounter">Scenario 1/5</span>
                    <span style="background: var(--warning-50); color: var(--warning-text); padding: 4px 12px; border-radius: 16px; font-size: 12px; font-weight: 600;" id="ageBadge">AGE 4-5</span>
                </div>

                <h2 id="scenarioTitle">🏗️ Block Building Challenge</h2>

                <div style="background: var(--surface-200); padding: 16px; border-radius: var(--border-radius-medium); margin: 16px 0; border-left: 4px solid var(--primary-500);">
                    <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 8px;">Scenario Context:</div>
                    <p id="scenarioContext" style="margin-bottom: 12px;">A 4-year-old child is building a tall tower with wooden blocks. They've been working carefully, concentrating intensely on balancing each block.</p>

                    <div style="background: var(--warning-50); padding: 12px; border-radius: var(--border-radius-small); border: 1px solid var(--warning-500);">
                        <strong style="color: var(--warning-text);">Child Behavior:</strong>
                        <span id="childBehavior" style="color: var(--text-primary); margin-left: 8px;">Suddenly, the tower falls down with a loud crash. The child looks frustrated, pushes the blocks away, and says "It's too hard! I can't do it!"</span>
                    </div>
                </div>

                <div style="margin: 20px 0;">
                    <label for="userResponse" style="display: block; margin-bottom: 8px; font-weight: 500;">As the educator, what would you say to this child?</label>
                    <textarea id="userResponse" class="text-input" placeholder="Type your response here..."></textarea>
                </div>

                <div style="display: flex; gap: 12px; margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="analyzeResponse()">🔍 Analyze Response</button>
                    <button class="btn btn-secondary" onclick="nextScenario()" id="nextBtn">Next Scenario</button>
                </div>

                <div id="results" style="display: none; margin-top: 20px; padding: 20px; background: var(--surface-50); border-radius: var(--border-radius-medium); border: 1px solid var(--surface-300);">
                    <h4 style="margin-bottom: 16px; color: var(--text-primary);">Classification Result</h4>
                    <div style="display: flex; gap: 20px; margin: 16px 0;">
                        <div style="flex: 1; text-align: center;">
                            <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-secondary);">OEQ (Open-Ended)</div>
                            <div class="metric-value" id="oeqScore">75%</div>
                        </div>
                        <div style="flex: 1; text-align: center;">
                            <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-secondary);">CEQ (Closed-Ended)</div>
                            <div class="metric-value" id="ceqScore">25%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Synthetic Data Tab -->
        <div id="synthetic-tab" class="tab-content">
            <div class="scenario-card">
                <h2>🤖 Synthetic Data Generation</h2>
                <p>Generate synthetic training examples to improve model performance</p>

                <div style="margin: 20px 0;">
                    <label for="syntheticCount" style="display: block; margin-bottom: 8px; font-weight: 500;">Number of examples to generate:</label>
                    <div style="display: flex; align-items: center; gap: 16px;">
                        <input type="number" id="syntheticCount" value="100" min="10" max="1000" class="text-input" style="width: 120px; min-height: auto;">
                        <button class="btn btn-primary">🎲 Generate Examples</button>
                    </div>
                </div>
            </div>

            <div class="scenario-card">
                <h3>Human Feedback Summary</h3>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">3</div>
                        <div class="metric-label">Total Feedback</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--success-500);">1</div>
                        <div class="metric-label">Correct Predictions</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--error-500);">2</div>
                        <div class="metric-label">Incorrect Predictions</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Tab -->
        <div id="metrics-tab" class="tab-content">
            <div class="scenario-card">
                <h2>📊 Model Performance Metrics</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">0.500</div>
                        <div class="metric-label">F1-Score</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">0.333</div>
                        <div class="metric-label">Accuracy</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">0.333</div>
                        <div class="metric-label">Precision</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">1.000</div>
                        <div class="metric-label">Recall</div>
                    </div>
                </div>
            </div>

            <div class="scenario-card">
                <h3>Confusion Matrix</h3>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>Predicted OEQ</th>
                            <th>Predicted CEQ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>Actual OEQ</th>
                            <td style="text-align: center;">1</td>
                            <td style="text-align: center;">0</td>
                        </tr>
                        <tr>
                            <th>Actual CEQ</th>
                            <td style="text-align: center;">2</td>
                            <td style="text-align: center;">0</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Model Training Tab -->
        <div id="retraining-tab" class="tab-content">
            <div class="scenario-card">
                <h2>🔧 Model Retraining Center</h2>
                <p>Retrain the model using collected human feedback</p>

                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">3</div>
                        <div class="metric-label">Total Feedback</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--success-500);">1</div>
                        <div class="metric-label">Correct Predictions</div>
                        <div style="font-size: 12px; color: var(--text-tertiary); margin-top: 4px;">TP: 1, TN: 0</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: var(--error-500);">2</div>
                        <div class="metric-label">Incorrect Predictions</div>
                        <div style="font-size: 12px; color: var(--text-tertiary); margin-top: 4px;">FP: 2, FN: 0</div>
                    </div>
                </div>

                <div style="margin-top: 20px; display: flex; gap: 12px;">
                    <button class="btn btn-primary">🚀 Start Retraining</button>
                    <button class="btn btn-secondary">📥 Download Training Data</button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-left">
                <div class="footer-logo">CL</div>
                <div>
                    © 2025 <a href="https://cultivatelearning.uw.edu/who-we-are/" target="_blank">Cultivate Learning</a>, University of Washington
                </div>
            </div>
            <div class="footer-right">
                <div class="build-number" id="buildNumber">BUILD v1.2.0-demo1</div>
            </div>
        </footer>
    </div>

    <script>
        // Child Scenarios Data
        const scenarios = [
            {
                id: 1,
                title: "🏗️ Block Building Challenge",
                age: "AGE 4-5",
                context: "A 4-year-old child is building a tall tower with wooden blocks. They've been working carefully, concentrating intensely on balancing each block.",
                behavior: "Suddenly, the tower falls down with a loud crash. The child looks frustrated, pushes the blocks away, and says \"It's too hard! I can't do it!\""
            },
            {
                id: 2,
                title: "🥕 Lunchtime Struggles",
                age: "AGE 3-4",
                context: "During lunch time, a 3-year-old is sitting at the table with a plate of vegetables and chicken. Other children around them are eating.",
                behavior: "The child pushes their plate away and crosses their arms, saying \"Yucky! I don't want vegetables!\" while making a disgusted face."
            },
            {
                id: 3,
                title: "🎨 Art Exploration",
                age: "AGE 4-5",
                context: "A 4-year-old is at the art table with paints, brushes, and paper. They're experimenting with mixing different colors.",
                behavior: "The child accidentally mixes too many colors and the paint turns brown. They look disappointed and say \"It's all muddy now! I wanted it to be pretty!\""
            },
            {
                id: 4,
                title: "🧸 Sharing Conflict",
                age: "AGE 3-4",
                context: "Two children are in the dramatic play area. One child is holding a popular toy that both children want to use.",
                behavior: "The child without the toy tries to grab it, saying \"I want it! Give it to me!\" while reaching for the toy. The other child holds it tighter."
            },
            {
                id: 5,
                title: "📚 Story Time Engagement",
                age: "AGE 4-5",
                context: "During circle time, you're reading a story about animals in the forest. The children are sitting on the carpet listening.",
                behavior: "One child gets excited and interrupts the story, jumping up and saying \"I saw a deer at my grandma's house! It was eating flowers!\""
            }
        ];

        let currentScenarioIndex = 0;

        // Scenario Management
        function loadScenario(index) {
            if (index >= 0 && index < scenarios.length) {
                const scenario = scenarios[index];
                document.getElementById('scenarioCounter').textContent = `Scenario ${index + 1}/${scenarios.length}`;
                document.getElementById('ageBadge').textContent = scenario.age;
                document.getElementById('scenarioTitle').textContent = scenario.title;
                document.getElementById('scenarioContext').textContent = scenario.context;
                document.getElementById('childBehavior').textContent = scenario.behavior;

                // Clear previous response and results
                document.getElementById('userResponse').value = '';
                document.getElementById('results').style.display = 'none';

                currentScenarioIndex = index;
            }
        }

        function nextScenario() {
            const nextIndex = (currentScenarioIndex + 1) % scenarios.length;
            loadScenario(nextIndex);
        }

        // Theme Management System
        class ThemeManager {
            constructor() {
                this.theme = localStorage.getItem('theme') || 'light';
                this.init();
            }

            init() {
                document.body.setAttribute('data-theme', this.theme);
                this.updateToggle();
                this.bindEvents();
            }

            toggle() {
                this.theme = this.theme === 'light' ? 'dark' : 'light';
                document.body.setAttribute('data-theme', this.theme);
                localStorage.setItem('theme', this.theme);
                this.updateToggle();
            }

            updateToggle() {
                const themeSwitch = document.getElementById('themeSwitch');
                if (this.theme === 'dark') {
                    themeSwitch.classList.add('active');
                } else {
                    themeSwitch.classList.remove('active');
                }
            }

            bindEvents() {
                document.getElementById('themeToggle').addEventListener('click', () => {
                    this.toggle();
                });
            }
        }

        // Tab Management System
        function showTab(tabName) {
            console.log('Switching to tab:', tabName);

            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show target tab
            const targetTab = document.getElementById(tabName + '-tab');
            if (targetTab) {
                targetTab.classList.add('active');
            }

            // Activate clicked button
            event.target.classList.add('active');
        }

        // Demo Analysis Function - REAL ML API
        async function analyzeResponse() {
            const response = document.getElementById('userResponse').value;
            if (!response.trim()) {
                alert('Please enter a response first!');
                return;
            }

            console.log('🧠 REAL ML ANALYSIS STARTING');
            console.log('=' * 60);
            console.log(`📝 Input Text: "${response}"`);
            console.log(`📏 Text Length: ${response.length} characters`);
            console.log(`🔤 Word Count: ${response.split(' ').length} words`);

            // Show results with loading state
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div style="text-align: center; padding: 20px;">⚡ Running neural network analysis...</div>';

            try {
                // Call REAL ML API
                const currentScenario = scenarios[currentScenarioIndex];
                console.log('\n🌐 API REQUEST:');
                console.log(`🎯 Endpoint: http://localhost:8001/classify_response`);
                console.log(`📋 Scenario ID: ${currentScenario.id}`);
                console.log(`🧠 Model: PyTorch Neural Network (4-layer, 56 features)`);

                const apiRequest = {
                    text: response,
                    scenario_id: currentScenario.id,
                    debug_mode: true
                };

                console.log('\n📤 REQUEST PAYLOAD:');
                console.log(JSON.stringify(apiRequest, null, 2));

                const apiResponse = await fetch('http://localhost:8001/classify_response', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(apiRequest)
                });

                if (!apiResponse.ok) {
                    throw new Error(`API Error: ${apiResponse.status} ${apiResponse.statusText}`);
                }

                const mlResult = await apiResponse.json();

                console.log('\n📥 REAL ML API RESPONSE:');
                console.log(JSON.stringify(mlResult, null, 2));

                console.log('\n🧠 NEURAL NETWORK DETAILS:');
                console.log(`🔢 Features Extracted: ${mlResult.features_used || 56}`);
                console.log(`🎯 Classification Method: ${mlResult.method}`);
                console.log(`📊 Raw Neural Outputs: [${mlResult.debug_info?.raw_outputs?.join(', ') || 'N/A'}]`);
                console.log(`🧮 Softmax Probabilities: [${mlResult.debug_info?.softmax_probs?.join(', ') || 'N/A'}]`);

                console.log('\n📈 FEATURE ANALYSIS:');
                if (mlResult.debug_info?.key_features) {
                    Object.entries(mlResult.debug_info.key_features).forEach(([feature, value]) => {
                        console.log(`  🔍 ${feature}: ${value}`);
                    });
                }

                console.log('\n🎯 FINAL CLASSIFICATION:');
                console.log(`📈 OEQ Probability: ${(mlResult.oeq_probability * 100).toFixed(1)}%`);
                console.log(`📉 CEQ Probability: ${(mlResult.ceq_probability * 100).toFixed(1)}%`);
                console.log(`🏆 Winner: ${mlResult.classification}`);
                console.log(`🎖️  Confidence: ${(mlResult.confidence * 100).toFixed(1)}%`);

                console.log('\n🏗️ SCENARIO CONTEXT:');
                console.log(`📋 Scenario: ${currentScenario.title}`);
                console.log(`👶 Age Group: ${currentScenario.age}`);
                console.log(`🎭 Child Behavior: ${currentScenario.behavior.substring(0, 100)}...`);

                console.log('\n✅ REAL NEURAL NETWORK Analysis Complete!');
                console.log('=' * 60);

                // Update display with real results
                const oeqPercent = Math.round(mlResult.oeq_probability * 100);
                const ceqPercent = Math.round(mlResult.ceq_probability * 100);

                // Restore results HTML structure with human feedback
                resultsDiv.innerHTML = `
                    <h4 style="margin-bottom: 16px; color: var(--text-primary);">ML Classification Result</h4>
                    <div style="display: flex; gap: 20px; margin: 16px 0;">
                        <div style="flex: 1; text-align: center;">
                            <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-secondary);">OEQ (Open-Ended)</div>
                            <div class="metric-value" id="oeqScore">${oeqPercent}%</div>
                        </div>
                        <div style="flex: 1; text-align: center;">
                            <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-secondary);">CEQ (Closed-Ended)</div>
                            <div class="metric-value" id="ceqScore">${ceqPercent}%</div>
                        </div>
                    </div>
                    <div style="margin-top: 16px; padding: 16px; background: var(--surface-200); border-radius: var(--border-radius-medium); border: 1px solid var(--surface-400);">
                        <div style="font-weight: 600; margin-bottom: 12px; color: var(--text-primary);">Human Verification (Training Data)</div>
                        <div style="margin-bottom: 12px; font-size: 14px; color: var(--text-secondary);">
                            Is this ML classification correct for your response?
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <button class="btn btn-primary" onclick="submitFeedback(true, '${mlResult.classification}', ${mlResult.confidence})" style="flex: 1;">
                                ✅ Correct
                            </button>
                            <button class="btn" onclick="submitFeedback(false, '${mlResult.classification}', ${mlResult.confidence})" style="flex: 1; background: var(--error-500); color: white;">
                                ❌ Incorrect
                            </button>
                        </div>
                    </div>
                    <div style="margin-top: 12px; font-size: 12px; color: var(--text-tertiary); text-align: center;">
                        4-layer neural network • ${mlResult.features_used || 56} features • Confidence: ${(mlResult.confidence * 100).toFixed(1)}%
                    </div>
                `;

            } catch (error) {
                console.error('❌ REAL ML API ERROR:', error);
                console.log('\n🚫 NO FALLBACK: Real ML API required!');
                console.log('🔧 To fix: Ensure PyTorch ML API is running on port 8001');
                console.log('💡 Start with: python3 ml_api_real.py');

                // Show error instead of fallback
                resultsDiv.innerHTML = `
                    <h4 style="margin-bottom: 16px; color: var(--error-500);">❌ Real ML API Not Available</h4>
                    <div style="color: var(--error-text); margin-bottom: 16px; background: var(--error-50); padding: 12px; border-radius: 6px;">
                        <strong>Error:</strong> Cannot connect to neural network API at localhost:8001<br>
                        <strong>Required:</strong> Real PyTorch model with 56-feature extraction<br>
                        <strong>Solution:</strong> Start the ML API with <code>python3 ml_api_real.py</code>
                    </div>
                    <div style="font-size: 14px; color: var(--text-secondary);">
                        🚫 No simulation or fallback - only real ML models allowed
                    </div>
                `;

                // Don't show fake results - leave empty
                console.log('🚫 Refusing to simulate - real ML required');
            }
        }

        // Human Feedback Submission Function
        async function submitFeedback(isCorrect, predictedClass, confidence) {
            try {
                const response = document.getElementById('userResponse').value;
                const currentScenario = scenarios[currentScenarioIndex];

                // Determine the correct class based on human feedback
                const correctClass = isCorrect ? predictedClass : (predictedClass === 'OEQ' ? 'CEQ' : 'OEQ');

                // Determine error type for training data
                let errorType;
                if (isCorrect) {
                    errorType = predictedClass === 'OEQ' ? 'TP' : 'TN'; // True Positive or True Negative
                } else {
                    errorType = predictedClass === 'OEQ' ? 'FP' : 'FN'; // False Positive or False Negative
                }

                const feedbackRequest = {
                    text: response,
                    predicted_class: predictedClass,
                    correct_class: correctClass,
                    error_type: errorType,
                    scenario_id: currentScenario.id,
                    timestamp: new Date().toISOString()
                };

                console.log('📝 SUBMITTING HUMAN FEEDBACK:');
                console.log(JSON.stringify(feedbackRequest, null, 2));

                const apiResponse = await fetch('http://localhost:8001/save_feedback', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(feedbackRequest)
                });

                if (!apiResponse.ok) {
                    throw new Error(`Feedback API Error: ${apiResponse.status} ${apiResponse.statusText}`);
                }

                const result = await apiResponse.json();
                console.log('✅ FEEDBACK SAVED:', result);

                // Update UI to show feedback was submitted
                const feedbackDiv = document.querySelector('.human-feedback');
                if (feedbackDiv) {
                    feedbackDiv.innerHTML = `
                        <div style="color: var(--success-500); font-weight: 600; margin-bottom: 8px;">
                            ✅ Feedback Submitted Successfully!
                        </div>
                        <div style="font-size: 14px; color: var(--text-secondary);">
                            Classification: ${isCorrect ? 'Correct' : 'Incorrect'} |
                            Error Type: ${errorType} |
                            Total Entries: ${result.total_entries}
                        </div>
                    `;
                }

            } catch (error) {
                console.error('❌ Error submitting feedback:', error);

                // Show error in UI
                const feedbackDiv = document.querySelector('.human-feedback');
                if (feedbackDiv) {
                    feedbackDiv.innerHTML = `
                        <div style="color: var(--error-500); font-weight: 600; margin-bottom: 8px;">
                            ❌ Failed to Submit Feedback
                        </div>
                        <div style="font-size: 14px; color: var(--text-secondary);">
                            Error: ${error.message}
                        </div>
                    `;
                }
            }
        }

        // Settings Management Functions
        let settings = {
            scenarioSource: 'simulations',
            showEducatorResponse: false,
            showConfidenceScores: true,
            comparisonMode: false,
            debugMode: false
        };

        function loadSettings() {
            const saved = localStorage.getItem('demo1Settings');
            if (saved) {
                settings = { ...settings, ...JSON.parse(saved) };
                // Apply settings to UI
                document.getElementById('scenarioSource').value = settings.scenarioSource;
                document.getElementById('showEducatorResponse').checked = settings.showEducatorResponse;
                document.getElementById('showConfidenceScores').checked = settings.showConfidenceScores;
                document.getElementById('comparisonMode').checked = settings.comparisonMode;
                document.getElementById('debugMode').checked = settings.debugMode;
            }
        }

        function saveSettings() {
            localStorage.setItem('demo1Settings', JSON.stringify(settings));
        }

        function openSettings() {
            loadSettings();
            document.getElementById('settingsModal').classList.add('active');
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function updateScenarioSource(value) {
            const desc = document.getElementById('sourceDescription');
            if (value === 'real_transcriptions') {
                desc.textContent = 'Actual classroom interactions from exemplar videos';
            } else {
                desc.textContent = 'AI-generated educational scenarios for training';
            }
        }

        function updateSettings() {
            // Update settings object from UI
            settings.scenarioSource = document.getElementById('scenarioSource').value;
            settings.showEducatorResponse = document.getElementById('showEducatorResponse').checked;
            settings.showConfidenceScores = document.getElementById('showConfidenceScores').checked;
            settings.comparisonMode = document.getElementById('comparisonMode').checked;
            settings.debugMode = document.getElementById('debugMode').checked;
        }

        function applySettings() {
            updateSettings();
            saveSettings();

            // Load appropriate scenarios based on settings
            if (settings.scenarioSource === 'real_transcriptions') {
                loadRealTranscriptions();
            } else {
                // Use existing scenarios
            }

            closeSettings();
            // Optionally reload current scenario with new settings
            loadScenario(currentScenarioIndex);
        }

        async function loadRealTranscriptions() {
            try {
                const response = await fetch('./real_transcriptions.json');
                const realScenarios = await response.json();

                // Transform real transcriptions to scenario format
                scenarios = realScenarios.map(scenario => ({
                    id: scenario.id,
                    title: scenario.title,
                    age: scenario.age,
                    context: scenario.context,
                    behavior: scenario.behavior,
                    // Additional real data
                    isReal: true,
                    educatorResponse: scenario.educatorResponse,
                    oeqScore: scenario.oeqScore,
                    ceqScore: scenario.ceqScore,
                    sourceVideo: scenario.sourceVideo,
                    timestamp: scenario.timestamp,
                    goldStar: scenario.goldStar
                }));

                console.log(`✨ Loaded ${scenarios.length} real transcriptions from gold star videos`);
                currentScenarioIndex = 0;
                loadScenario(0);
            } catch (error) {
                console.error('Failed to load real transcriptions:', error);
                alert('Unable to load real transcriptions. Using simulations instead.');
            }
        }

        // Close modal when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('settingsModal');
            if (e.target === modal) {
                closeSettings();
            }
        });

        // Initialize theme manager and load first scenario on page load
        document.addEventListener('DOMContentLoaded', () => {
            new ThemeManager();
            loadSettings(); // Load settings on startup
            loadScenario(0); // Load first scenario

            // Update build number with timestamp
            const buildDate = new Date().toISOString().split('T')[0].replace(/-/g, '');
            const buildTime = new Date().toTimeString().split(' ')[0].replace(/:/g, '');
            document.getElementById('buildNumber').textContent = `BUILD v1.2.0-demo1.${buildDate}.${buildTime}`;

            // Console welcome message
            console.log('%c🎭 ECE Question Classification System - Demo 1', 'font-size: 20px; font-weight: bold; color: #0078D4;');
            console.log('%c💡 ML Debug Mode Enabled', 'font-size: 16px; font-weight: bold; color: #107C10;');
            console.log('📝 Type a response and click "Analyze Response" to see detailed ML analysis output!');
            console.log('🔍 Watch this console for feature extraction, scoring, and classification results.');
            console.log('⚙️ ML Features: Pattern matching, linguistic indicators, question analysis');
            console.log('🎯 Classification: Open-Ended Questions (OEQ) vs Closed-Ended Questions (CEQ)');
            console.log(`🔧 Build: v1.2.0-demo1.${buildDate}.${buildTime}`);
            console.log('=' * 60);
        });
    </script>
</body>
</html>